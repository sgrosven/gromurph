apply plugin: 'java'
apply plugin: 'com.bmuschko.izpack'

sourceCompatibility = 1.7
version = '7.3.1'
jar {
	archiveName = 'JavaScore.jar'
    manifest {
        attributes 'Implementation-Title': 'JavaScore Regatta Scoring',
                   'Implementation-Version': version,
                   'Main-Class': 'org.gromurph.javascore.Javascore'
    }
}

repositories {
    maven {
    	url './local-repo'
    }
    mavenCentral()
    jcenter()
}

dependencies {
   compile group: 'commons-collections', name: 'commons-collections', version: '3.2'
   compile group: 'javax.xml.bind', name: 'jaxb-api', version: '2.2.12'
   compile group: 'javax.help', name: 'javahelp', version: '2.0.05'
   compile group: 'com.toedter', name: 'jcalendar', version: '1.4'
   compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.10'
   compile group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.1'
   compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.1'
   compile group: 'org.apache.logging.log4j', name: 'log4j-slf4j-impl', version: '2.1'
   compile group: 'commons-io', name: 'commons-io', version: '2.4'
   compile group: 'commons-net', name: 'commons-net', version: '3.3'
   compile group: 'commons-codec', name: 'commons-codec', version: '1.10'
   compile group: 'jakarta-regexp', name: 'jakarta-regexp', version: '1.4'
   compile group: 'org.apache.httpcomponents', name: 'httpclient', version: '4.4'
    
   // testing only 
   testCompile group: 'junit', name: 'junit', version: '4.+'
   testCompile group: 'org-uispec4j', name: 'uispec4j', version: '2.5-SNAPSHOT'
   
   // local repo
   compile group: 'dbswing', name: 'dbswing', version: '0.0'
   compile group: 'sailing-org', name: 'sailingXrr', version: '1.3'
    
   // release packaging
   izpack 'org.codehaus.izpack:izpack-standalone-compiler:4.3.5'

}

buildscript {
	repositories {
		jcenter()
	}
	dependencies {
   		classpath 'com.bmuschko:gradle-izpack-plugin:2.0'
	}
}

task copyDependentJars(type: Copy) {
    into "$buildDir/assemble"
    from configurations.runtime
}

task copyIzPack(type: Copy) {
    into "$buildDir/assemble"
    from "src/main/izpack"
}

izpack {
    baseDir = file("$buildDir/assemble")
    appProperties = [
    	'app.group': 'org-gromurph', 
    	'app.name': 'JavaScore', 
    	'app.title': 'JavaScore',
        'app.version': version, 
        'app.subpath': "Javascore-$version"]
}

task buildInstaller {
	dependsOn jar, copyDependentJars, copyIzPack, izPackCreateInstaller
}